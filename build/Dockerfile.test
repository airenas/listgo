#########################################################################################
## docker will invoke this file from ../.. dir in order to access code
#########################################################################################
FROM golang:1.17 as builder

ARG BUILD_VERSION=0.1

RUN apt update && apt install -y protobuf-compiler
WORKDIR /go/src/
COPY . /go/src

ENV CGO_ENABLED=1
RUN make install/librkafka
RUN make generate/proto
RUN make generate/mocks

RUN make test/unit
RUN make test/lint
